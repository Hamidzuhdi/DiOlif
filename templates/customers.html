<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Manajemen Pelanggan - Konveksi</title>
  <style>
    * { box-sizing: border-box; font-family: Arial, sans-serif; margin: 0; padding: 0; }

    body {
      display: flex;
      height: 100vh;
      background: #f9f9f9;
    }

    .sidebar {
      width: 250px;
      background-color: #2f44c4;
      color: white;
      padding-top: 20px;
    }

    .sidebar h2 {
      text-align: center;
      margin-bottom: 30px;
      font-size: 20px;
    }

    .sidebar a {
      display: block;
      padding: 15px 25px;
      color: white;
      text-decoration: none;
      font-weight: bold;
    }

    .sidebar a.active {
      background-color: #536dfe;
      border-left: 6px solid #ffc107;
    }

    .sidebar a:hover {
      background-color: #4d60e2;
    }

    .main {
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .header {
      background-color: #2979ff;
      color: white;
      padding: 15px 20px;
      display: flex;
      justify-content: flex-end;
      align-items: center;
    }

    .logout-btn {
      background-color: #ff4d4f;
      border: none;
      padding: 8px 16px;
      color: white;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
    }

    .content {
      padding: 30px;
    }

    .content h2 {
      margin-bottom: 15px;
    }

    .actions {
      margin-bottom: 20px;
    }

    .actions button {
      padding: 6px 12px;
      margin-bottom: 10px;
      border: 1px solid #333;
      background-color: #f1f1f1;
      cursor: pointer;
    }

    .filter {
      margin-top: 10px;
    }

    .filter select {
      padding: 4px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background-color: #fff;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

    table thead {
      background-color: #f1f3f4;
    }

    table th, table td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }

    .table-title {
      margin-top: 20px;
      font-weight: bold;
    }

  </style>
</head>
<body>
  <div class="sidebar">
    <h2>Konveksi Internal System</h2>
    <a href="/dashboard">Dashboard</a>
    <a href="#" class="active">Manajemen Pelanggan</a>
    <a href="/transactions">Manajemen Transaksi</a>
    
  </div>

  <div class="main">
    <div class="header">
      <form action="/logout" method="POST" style="margin:0;">
        <button class="logout-btn" type="submit">Logout</button>
      </form>
    </div>

    <div class="content">
      <h2>Manajemen Pelanggan</h2>

      <div class="actions">
        <a href="/add-customer" style="display:inline-block;padding:6px 12px;margin-bottom:10px;border:1px solid #333;background-color:#f1f1f1;color:#222;text-decoration:none;">Tambah Pelanggan Baru</a>
        
        <div class="filter">
          <label for="tipe">Filter Tipe Pelanggan:</label>
          <select id="tipe" name="tipe">
            <option value="semua">None</option>
            <option value="SD">SD</option>
            <option value="Kelompok Tadarus">Kelompok Tadarus</option>
            <option value="Lainnya">Lainya</option>
            <option value="TK">TK</option>
            <option value="SMP">SMP</option>
          </select>
        </div>
      </div>

      <div class="table-title">Daftar pelanggan yang terdaftar</div>
      <table>
        <thead>
          <tr>
            <th>Nama</th>
            <th>Tipe</th>
            <th>kontak</th>
            <th>alamat</th>
            <th>Aksi</th>
          </tr>
        </thead>
        <tbody>
          <!-- Data pelanggan akan muncul di sini -->
        </tbody>
      </table>
    </div>
  </div>
  <!-- ...existing code... -->
<!-- ...existing code... -->
<tbody>
  <!-- Data pelanggan akan muncul di sini -->
</tbody>
<!-- ...existing code... -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Ambil data pelanggan dari API
  fetch('/api/customers')
    .then(res => res.json())
    .then(customers => {
      const tbody = document.querySelector('tbody');
      tbody.innerHTML = ''; // Kosongkan dulu
      customers.forEach(c => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${c.name}</td>
          <td>${c.type}</td>
          <td>${c.contact || '-'}</td>
          <td>${c.address || '-'}</td>
          <td>
            <button onclick="editCustomer(${c.id})">Edit Customer</button>
            <button onclick="addCustomerUniform(${c.id})" style="background:#2979ff;color:#fff;">Tambah Seragam</button>
            <button onclick="detailUniformCust(${c.id})" style="background:#ffc107;color:#222;">Detail Seragam</button>
            <button onclick="deleteCustomer(${c.id})" style="background:#ff4d4f;color:white;">Hapus</button>
          </td>
        `;
        tbody.appendChild(tr);
      });
    });

  document.getElementById('tipe').addEventListener('change', function() {
    const tipe = this.value;
    fetch('/api/customers')
      .then(res => res.json())
      .then(customers => {
        const tbody = document.querySelector('tbody');
        tbody.innerHTML = '';
        customers
          .filter(c => tipe === 'semua' || c.type === tipe)
          .forEach(c => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
              <td>${c.name}</td>
              <td>${c.type}</td>
              <td>${c.contact || '-'}</td>
              <td>${c.address || '-'}</td>
              <td>
                <button onclick="editCustomer(${c.id})">Edit Customer</button>
                <button onclick="detailUniformCust(${c.id})" style="background:#ffc107;color:#222;">Detail Seragam</button>
                <button onclick="addCustomerUniform(${c.id})" style="background:#2979ff;color:#fff;">Tambah Seragam</button>
                <button onclick="deleteCustomer(${c.id})" style="background:#ff4d4f;color:white;">Hapus</button>
              </td>
            `;
            tbody.appendChild(tr);
          });
      });
  });
});
function addCustomerUniform(id) {
  window.location.href = '/add-custuniform/' + id;
}

// Fungsi hapus pelanggan
function deleteCustomer(id) {
  if (!confirm('Yakin ingin menghapus pelanggan ini?')) return;
  fetch('/api/customers/' + id, { method: 'DELETE' })
    .then(res => {
      if (res.ok) location.reload();
      else alert('Gagal menghapus pelanggan');
    });
}

function detailUniformCust(id) {
  window.location.href = '/detailuniformcust/' + id;
}

// Fungsi edit pelanggan
function editCustomer(id) {
  window.location.href = '/edit-customer/' + id;
}

// Fungsi edit seragam pelanggan
function editCustomerUniform(id) {
  window.location.href = '/edit-custuniform/' + id;
}
</script>
<!-- ...existing code... -->
</body>
</html>
</body>
</html>
